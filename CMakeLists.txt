cmake_minimum_required(VERSION 3.10)
project(MiniBrowser)

# –û—Ç–∫–ª—é—á–∞–µ–º —Ç–µ—Å—Ç—ã –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ (–≥–æ–≤–æ—Ä–∏–º, –æ —Ç–æ–º —á—Ç–æ –æ–Ω —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω), –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç
set(CMAKE_CXX_COMPILER_WORKS 1)
set(CMAKE_C_COMPILER_WORKS 1)

# –£–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å C++17 —Å—Ç–∞–Ω–¥–∞—Ä—Ç.
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# –û–ø—Ü–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è Gumbo
option(USE_GUMBO "Use Gumbo HTML parser" ON)

# –ò—â–µ–º –≤—Å–µ .cpp —Ñ–∞–π–ª—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ
file(GLOB_RECURSE SRC_FILES "src/*.cpp")

# –°–æ–∑–¥–∞–µ–º –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
add_executable(mini_browser ${SRC_FILES})

# –í–∫–ª—é—á–∞–µ–º –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã
target_include_directories(mini_browser PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/src)

# –ó–∞–ø—Ä–µ—â–∞–µ–º CMake –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã
set(CMAKE_CXX_COMPILER_ID_RUN 1)

# –£—Å–ª–æ–≤–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Gumbo
if(USE_GUMBO)
    find_library(GUMBO_LIBRARY gumbo)
    find_path(GUMBO_INCLUDE_DIR gumbo.h)
    
    if(GUMBO_LIBRARY AND GUMBO_INCLUDE_DIR)
        message(STATUS "‚úÖ Gumbo found - HTML parsing enabled")
        
        # –ü–æ–¥–∫–ª—é—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ Gumbo (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ .h)
        target_include_directories(mini_browser PRIVATE ${GUMBO_INCLUDE_DIR})
        
        # –õ–∏–Ω–∫—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É Gumbo (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è .h —Ñ–∞–π–ª–æ–≤ –≤ .cpp)
        target_link_libraries(mini_browser ${GUMBO_LIBRARY})
    else()
        message(WARNING "‚ùå Gumbo not found - HTML parsing disabled")
    endif()
else()
    message(STATUS "üîï Gumbo disabled by user")
endif()